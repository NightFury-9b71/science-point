import{j as e}from"./query-vendor.8wxMU1ov.js";import{u as T,r as x,c as _,d as n}from"./router-vendor.hUHkLMlj.js";import{u as B}from"./teacher-pages.Do1_KYSo.js";import{w as G}from"./withAuthGuard.DUcKPOLq.js";import{y as $,z as I,m as O,A as z,B as F,C as l,S as w,D as H,E as U,G as Y,H as q,J,K,N as Q,O as V}from"./admin-pages.BUna6bVg.js";import{A as W,U as X,B as Z,C as ee,k as se,V as te,r as S,o as P,Y as ae}from"./ui-vendor.D9emdPb2.js";import le from"./NotFound.CivlE6fY.js";import"./react-vendor.CdglivQu.js";import"./http-vendor.BNtd7jmy.js";const re=()=>{const i=T(),[o,C]=x.useState(""),[A,k]=x.useState("all"),{data:m=[]}=$(),{data:M=[]}=I(),{data:u=[]}=O(),{data:p=[]}=z(),j=x.useMemo(()=>o?m.filter(s=>s.class_id===parseInt(o)):m,[m,o]),a=x.useMemo(()=>{const s=j.map(t=>{const r=u.filter(c=>c.student_id===t.id),E=r.reduce((c,g)=>c+g.marks_obtained,0),f=r.reduce((c,g)=>c+g.exam?.max_marks||0,0),b=f>0?E/f*100:0,N=p.filter(c=>c.student_id===t.id),h=N.length,v=N.filter(c=>c.status==="present").length,y=h>0?v/h*100:0,L=b*.7+y*.3;return{student:t,averageMarks:Math.round(b*100)/100,attendancePercentage:Math.round(y*100)/100,overallPerformance:Math.round(L*100)/100,totalExams:r.length,presentDays:v,totalDays:h}});s.sort((t,r)=>r.overallPerformance-t.overallPerformance);const d={totalStudents:s.length,averageClassMarks:s.length>0?Math.round(s.reduce((t,r)=>t+r.averageMarks,0)/s.length*100)/100:0,averageClassAttendance:s.length>0?Math.round(s.reduce((t,r)=>t+r.attendancePercentage,0)/s.length*100)/100:0,excellentPerformers:s.filter(t=>t.overallPerformance>=85).length,goodPerformers:s.filter(t=>t.overallPerformance>=70&&t.overallPerformance<85).length,needsImprovement:s.filter(t=>t.overallPerformance<70).length};return{studentPerformance:s,classStats:d}},[j,u,p]),D=s=>s>=90?{grade:"A+",color:"text-green-600",bgColor:"bg-green-100"}:s>=80?{grade:"A",color:"text-green-600",bgColor:"bg-green-100"}:s>=70?{grade:"B",color:"text-blue-600",bgColor:"bg-blue-100"}:s>=60?{grade:"C",color:"text-yellow-600",bgColor:"bg-yellow-100"}:s>=50?{grade:"D",color:"text-orange-600",bgColor:"bg-orange-100"}:{grade:"F",color:"text-red-600",bgColor:"bg-red-100"},R=s=>s>=85?{status:"Excellent",color:"text-green-600",bgColor:"bg-green-100"}:s>=75?{status:"Good",color:"text-blue-600",bgColor:"bg-blue-100"}:s>=65?{status:"Average",color:"text-yellow-600",bgColor:"bg-yellow-100"}:{status:"Poor",color:"text-red-600",bgColor:"bg-red-100"};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-3 sm:space-y-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>i("/admin"),className:"lg:hidden",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Performance Analytics"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Student performance based on marks and attendance"})]})]})}),e.jsx(l,{className:"p-6 shadow-lg border-0 bg-gradient-to-r from-white to-gray-50",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(w,{label:"Filter by Class",value:o,onChange:s=>C(s.target.value),options:[{value:"",label:"All Classes"},...M.map(s=>({value:s.id,label:s.name}))],className:"text-base"}),e.jsx(w,{label:"Time Period",value:A,onChange:s=>k(s.target.value),options:[{value:"all",label:"All Time"},{value:"month",label:"Last Month"},{value:"quarter",label:"Last Quarter"},{value:"year",label:"Last Year"}],className:"text-base"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(l,{className:"p-6 shadow-lg border-0 bg-gradient-to-br from-blue-50 to-blue-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-blue-500 rounded-lg",children:e.jsx(X,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.classStats.totalStudents})]})]})}),e.jsx(l,{className:"p-6 shadow-lg border-0 bg-gradient-to-br from-green-50 to-green-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-500 rounded-lg",children:e.jsx(Z,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Avg. Marks"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[a.classStats.averageClassMarks,"%"]})]})]})}),e.jsx(l,{className:"p-6 shadow-lg border-0 bg-gradient-to-br from-purple-50 to-purple-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-500 rounded-lg",children:e.jsx(ee,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Avg. Attendance"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[a.classStats.averageClassAttendance,"%"]})]})]})}),e.jsx(l,{className:"p-6 shadow-lg border-0 bg-gradient-to-br from-yellow-50 to-yellow-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 bg-yellow-500 rounded-lg",children:e.jsx(se,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-600",children:"Excellent"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:a.classStats.excellentPerformers})]})]})})]}),e.jsxs(l,{className:"shadow-lg border-0",children:[e.jsx(l.Header,{className:"p-6 bg-gradient-to-r from-indigo-50 to-purple-50 border-b",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(te,{className:"h-6 w-6 text-indigo-600"}),e.jsx(l.Title,{className:"text-lg font-bold text-gray-900",children:"Performance Distribution"})]})}),e.jsx(l.Content,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto bg-green-100 rounded-full flex items-center justify-center mb-3",children:e.jsx("span",{className:"text-2xl font-bold text-green-600",children:a.classStats.excellentPerformers})}),e.jsx("p",{className:"font-semibold text-green-700",children:"Excellent (85%+)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.classStats.totalStudents>0?Math.round(a.classStats.excellentPerformers/a.classStats.totalStudents*100):0,"% of students"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto bg-blue-100 rounded-full flex items-center justify-center mb-3",children:e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:a.classStats.goodPerformers})}),e.jsx("p",{className:"font-semibold text-blue-700",children:"Good (70-84%)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.classStats.totalStudents>0?Math.round(a.classStats.goodPerformers/a.classStats.totalStudents*100):0,"% of students"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-3",children:e.jsx("span",{className:"text-2xl font-bold text-red-600",children:a.classStats.needsImprovement})}),e.jsx("p",{className:"font-semibold text-red-700",children:"Needs Improvement (<70%)"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.classStats.totalStudents>0?Math.round(a.classStats.needsImprovement/a.classStats.totalStudents*100):0,"% of students"]})]})]})})]}),e.jsxs(l,{className:"shadow-lg border-0",children:[e.jsx(l.Header,{className:"p-6 bg-gradient-to-r from-gray-50 to-gray-100 border-b",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{className:"h-6 w-6 text-gray-600"}),e.jsx(l.Title,{className:"text-lg font-bold text-gray-900",children:"Student Performance Details"})]})}),e.jsx(l.Content,{className:"p-0",children:a.studentPerformance.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Roll No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marks (%)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Attendance (%)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Overall (%)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Grade"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.studentPerformance.map((s,d)=>{const t=D(s.overallPerformance),r=R(s.attendancePercentage);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${d===0?"bg-yellow-100 text-yellow-800":d===1?"bg-gray-100 text-gray-800":d===2?"bg-orange-100 text-orange-800":"bg-gray-50 text-gray-600"}`,children:d+1})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:s.student.user?.full_name||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.student.roll_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[s.averageMarks,"%"]}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",s.totalExams," exams)"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${r.bgColor} ${r.color}`,children:[s.attendancePercentage,"%"]}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",s.presentDays,"/",s.totalDays,")"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"font-bold text-gray-900",children:[s.overallPerformance,"%"]}),s.overallPerformance>=85?e.jsx(P,{className:"ml-2 h-4 w-4 text-green-500"}):s.overallPerformance>=70?e.jsx(P,{className:"ml-2 h-4 w-4 text-blue-500"}):e.jsx(ae,{className:"ml-2 h-4 w-4 text-red-500"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.bgColor} ${t.color}`,children:t.grade})})]},s.student.id)})})]})}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(S,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Performance Data"}),e.jsx("p",{className:"text-gray-500",children:o?"No students found in the selected class.":"No students available to display performance data."})]})})]})]})},ne=()=>{const{user:i}=B();return!i||i.role!=="admin"?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("div",{className:"text-yellow-600 mb-2",children:e.jsx("svg",{className:"h-8 w-8 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h3",{className:"text-lg font-medium text-yellow-900 mb-2",children:"Admin Access Required"}),e.jsx("p",{className:"text-yellow-700",children:"You need admin access to view this dashboard. Please contact the administrator."})]})}):e.jsxs(_,{children:[e.jsx(n,{index:!0,element:e.jsx(H,{})}),e.jsx(n,{path:"students",element:e.jsx(U,{})}),e.jsx(n,{path:"teachers",element:e.jsx(Y,{})}),e.jsx(n,{path:"classes",element:e.jsx(q,{})}),e.jsx(n,{path:"subjects",element:e.jsx(J,{})}),e.jsx(n,{path:"notices",element:e.jsx(K,{})}),e.jsx(n,{path:"schedule",element:e.jsx(Q,{})}),e.jsx(n,{path:"performance",element:e.jsx(re,{})}),e.jsx(n,{path:"profile",element:e.jsx(V,{})}),e.jsx(n,{path:"*",element:e.jsx(le,{})})]})},pe=G(ne,["admin"]);export{pe as default};
