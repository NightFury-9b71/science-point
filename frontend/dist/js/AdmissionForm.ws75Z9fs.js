import{j as e}from"./query-vendor.8wxMU1ov.js";import{u as S,r as m}from"./router-vendor.hUHkLMlj.js";import{d as w,G as C,A,t as c}from"./ui-vendor.D9emdPb2.js";import{v as P,w as q,C as b,B as u,I as n,S as I,x as D}from"./admin-pages.BUna6bVg.js";import"./react-vendor.CdglivQu.js";import"./http-vendor.BNtd7jmy.js";const $=()=>{const o=S(),{data:g=[]}=P(),d=q(),[a,h]=m.useState({user:{email:"",full_name:"",phone:""},parent_name:"",parent_phone:"",address:"",date_of_birth:"",class_id:""}),[r,x]=m.useState({}),[f,_]=m.useState(!1),j=g.map(s=>({value:s.id.toString(),label:`${s.name} (Grade ${s.grade}${s.section?` - ${s.section}`:""})`})),t=(s,l)=>{if(s.includes(".")){const[i,y]=s.split(".");h(p=>({...p,[i]:{...p[i],[y]:l}}))}else h(i=>({...i,[s]:l}));r[s]&&x(i=>({...i,[s]:""}))},v=()=>{const s={};return a.user.email.trim()&&!/\S+@\S+\.\S+/.test(a.user.email)&&(s["user.email"]="Please enter a valid email address"),a.user.full_name.trim()||(s["user.full_name"]="Full name is required"),a.user.phone.trim()||(s["user.phone"]="Phone number is required"),a.class_id||(s.class_id="Please select a class"),a.date_of_birth||(s.date_of_birth="Date of birth is required"),a.parent_phone.trim()||(s.parent_phone="Parent/Guardian phone number is required"),x(s),Object.keys(s).length===0},N=async s=>{if(s.preventDefault(),!v()){c.error("Please fix the errors in the form");return}try{const l={full_name:a.user.full_name,email:a.user.email||null,phone:a.user.phone,parent_name:a.parent_name||null,parent_phone:a.parent_phone,address:a.address||null,date_of_birth:a.date_of_birth?new Date(a.date_of_birth).toISOString():null,class_id:parseInt(a.class_id)};await d.mutateAsync(l),_(!0),c.success("Admission request submitted successfully!"),setTimeout(()=>{o("/login")},3e3)}catch(l){const i=l.response?.data?.detail||"Failed to submit admission request. Please try again.";c.error(i)}};return f?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-gray-50 flex items-center justify-center px-4",children:e.jsxs(b,{className:"max-w-md w-full p-8 text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(w,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admission Submitted!"}),e.jsx("p",{className:"text-gray-600",children:"Your admission request has been submitted successfully. You will be redirected to the login page shortly."})]}),e.jsx(u,{onClick:()=>o("/login"),className:"w-full",children:"Go to Login"})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-gray-50",children:[e.jsx("header",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{className:"h-8 w-8 text-slate-600"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"Science Point"})]}),e.jsxs(u,{variant:"outline",onClick:()=>o("/"),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Back to Home"]})]})})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Student Admission Form"}),e.jsx("p",{className:"text-gray-600",children:"Fill out the form below to apply for admission"})]}),e.jsx(b,{className:"p-8",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{label:"Full Name",value:a.user.full_name,onChange:s=>t("user.full_name",s.target.value),error:r["user.full_name"],required:!0}),e.jsx(n,{label:"Email Address",type:"email",value:a.user.email,onChange:s=>t("user.email",s.target.value),error:r["user.email"]}),e.jsx(n,{label:"Phone Number",value:a.user.phone,onChange:s=>t("user.phone",s.target.value),error:r["user.phone"],required:!0}),e.jsx(n,{label:"Date of Birth",type:"date",value:a.date_of_birth,onChange:s=>t("date_of_birth",s.target.value),error:r.date_of_birth,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Academic Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(I,{label:"Desired Class",options:j,value:a.class_id,onChange:s=>t("class_id",s.target.value),error:r.class_id,placeholder:"Select a class",required:!0})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Parent/Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(n,{label:"Parent/Guardian Name",value:a.parent_name,onChange:s=>t("parent_name",s.target.value),error:r.parent_name}),e.jsx(n,{label:"Parent/Guardian Phone",value:a.parent_phone,onChange:s=>t("parent_phone",s.target.value),error:r.parent_phone,required:!0})]}),e.jsx("div",{className:"mt-4",children:e.jsx(D,{label:"Address",value:a.address,onChange:s=>t("address",s.target.value),error:r.address,rows:3})})]}),e.jsx("div",{className:"pt-6 border-t border-gray-200",children:e.jsx(u,{type:"submit",className:"w-full",disabled:d.isLoading,children:d.isLoading?"Submitting...":"Submit Admission Request"})})]})})]})]})};export{$ as default};
